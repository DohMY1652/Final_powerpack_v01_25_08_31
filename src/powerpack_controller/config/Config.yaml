# [MODIFIED] Added 'pp_controller:' as the top-level key and indented all content.
pp_controller:
  ros__parameters:

    # === per-channel calibration (map-based) ===
    Sensor_calibration:
      atm_offset: 101.325
      b0:
        "0": { offset: 862.0,  gain: 0.3055 }
        "1": { offset: 854.0,  gain: 0.3055 }
        "2": { offset: 855.0,  gain: 0.3055 }
        "3": { offset: 868.0,  gain: 0.3055 }
      b1:
        "0": { offset: 844.0,  gain: 0.3055   }
        "1": { offset: 855.0,  gain: 0.3055 }
        "2": { offset: 443.0,  gain: -0.00276 }
        "3": { offset: 458.0,  gain: -0.00276 }
      b2:
        "0": { offset: 414.0,  gain: -0.00276 }
        "1": { offset: 429.0,  gain: -0.00276 }
        "2": { offset: 423.0,  gain: -0.00276 }
        "3": { offset: 450.0,  gain: -0.00276 }
        "4": { offset: 434.0,  gain: 0.272 }   # pos line (핀20)
        "5": { offset: 429.0,  gain: -0.00276 }  # neg line (핀21)
        "6": { offset: 493.0,  gain: 0.272 }   # macro line (핀22)

    RefTcp:
      enable: true
      bind_address: "0.0.0.0"
      port: 15000
      expect_n: 12
      scale: 0.01

    LinePID:
      pos:
        kp: 0.8
        ki: 0.2
        kd: 0.0
        ref: 150.0
        pwm_index: 12
      # 주의: 현재 코드엔 neg PID 사용 안 함(무시됨)
      out_min: 0.0
      out_max: 100.0

    Reference_parameters:
      frequency: 1000

    PWM_parameters:
      frequency: 1000
      pid_pos_index: 18
      pid_neg_index: 19

    MPC_parameters:
      NP: 5
      n_x: 1
      n_u: 3
      Ts: 0.01
      Q_values: 10.0
      R_values: 1.0
      pos_ku_micro: 0.5
      pos_ku_macro: 0.5
      pos_ku_atm: 2.0
      neg_ku_micro: 3.0
      neg_ku_macro: 3.0
      neg_ku_atm: 6.0

    channel_volume:
      pos1: 100
      pos2: 100
      pos3: 100
      neg1: 100
      neg2: 100
      neg3: 100

    system_parameters:
      sensor_print: true
      reference_print: true
      pwm_print: true
      valve_operate: false

    MacroSwitch:
      threshold_kpa: 600.0